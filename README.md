# [내일배움캠프] 유니티 숙련주차 개인과제

> **제작 목표**
> - 필수기능 구현 및 도전 기능 구현
> - 사용하는 코드에 대한 충분한 이해와 배운 패턴 활용해보기
<br>

> - **⚙ [기술설명]**
>   - 구현 방법
>   - 트러블 슈팅
>   - 학습한 부분 확인하기
> - [UI]
>   - [반응형 UI]
>   - [상호작용 가능한 오브젝트 표시]
> - [조작]
>   - [기본 이동 및 점프]
>   - [벽타기 및 매달리기]
>   - [3인칭시점]
> - [아이템]
>   - [아이템 데이터]
>   - [아이템 사용]
>   - [장비 장착]
>   - [다양한 아이템 구현]
> - [플랫폼]
>   - [점프대]
>   - [움직이는 플랫폼]
>   - [플랫폼 발사기]
>   - [레이저 트랩]
> - [AI]
>   - [발전형 AI]
<br>

---
## UI
<br>

---
### 반응형 UI
- 구현 방법<br>
반응형 UI의 경우, 체력과 배고픔, 정신력을 한 번에 제작했었습니다.
각 능력치는 `BarStat.cs`에서 `Add,Sub`를 통해 값을 조정하며, `ReloadBar`를 통해 화면에 현재 수치를 반영합니다.
`Status.cs`에서는 모든 `BarStat.cs`을 가져와서 런타임동안 서서히 감소되도록 했습니다.
<br>

- 학습한 부분 확인하기
  - `BarStat.cs`처럼 하나의 스탯을 하나의 블럭으로 만들기
  - `Status.cs`로 하나로 `BarStat.cs` 묶기
<br>

### 상호 작용 가능한 오브젝트 표시
- 구현 방법<br>
상호작용하기 위해 필요한 ray를 쓰기 위해서 `PlayerRay.cs`를 따로 만들어서 관리했습니다. Cursor를 고정하여 플레이어의 마우스가 화면의 중앙에 위치하게 만들어 플레이어가 보는 방향에 Ray를 쏘아 보는 대상이 감별할 수 있는지 확인하고 `SetPromptText`라는 메서드를 통해 내용을 표시합니다.
<br>

- 학습한 부분 확인하기
  - ray 활용하기
<br>

---
## 조작
<br>

---
### 기본 이동 및 점프
- 구현 방법 <br>
`PlayerKey.cs`의 데이터를 통해 WASD로 이동을 구현했고 마우스의 방향에 따라 시야가 움직이도록 했습니다. Y축이 무한이 돌아가면 안되기에 시야가 일정 범위를 나가지 않도록 조정했습니다. 점프는 AddForce로 구현했으며, 점프할 때 스테미나가 감소합니다. 
<br>

- 트러블 슈팅
1. 플레이어의 velocity 강제 적용 방식으로 인해 다른 플랫폼을 다룰 때 문제.
  1. 플랫폼이 활용되는 동안 move를 비활성화로 해결.   
<br>

- 학습한 부분 확인하기
  - `InputSystem` 활용하기
  - `Status.cs`로 하나로 `BarStat.cs` 묶기
<br>

### 벽타기 및 매달리기
- 구현 방법<br>
`PlayerKey.cs`에서 구현, G키를 누르면 Gravity를 비활성화 시키는 것으로 매달리는 것을 구현했습니다. 매달린 상태에서는 점프가 가능하도록 하였고 Move를 할 경우에는 매달린 상태가 해제됩니다.
<br>

- 학습한 부분 확인하기
  - 다양한 예외상황을 막기
<br>

### 3인칭 시점
- 구현 방법<br>
`PlayerKey.cs`에서 R키를 누르면 카메라의 위치를 바꿔주는 것으로 구현했습니다. 
<br>

- 트러블 슈팅
1. 본래 카메라 시야각을 활용 시, 플레이어의 몸체를 벗어나서 시야를 봄.
  1. 시야가 바뀔 때, 시야 반경도 제한.
<br>

- 학습한 부분 확인하기
  - 카메라 시점 생각해보기
<br>

---
## 아이템
<br>

---
### 아이템 데이터
- 구현 방법 <br>
`ScriptableObject`타입의 `ItemData.cs`를 활용하여 아이템 데이터를 쉽게 관리하고 `ItemObject.cs`에 값을 넣어주는 것으로 오브젝트에 데이터를 넣을 수 있게 만들었습니다. 
<br>

- 학습한 부분 확인하기
  - `ScriptableObject` 활용하기
  - `ItemData.cs`와 `ItemObject.cs` 방식 활용하기
<br>

### 아이템 사용
- 구현 방법<br>
`Inventory.cs`를 만들어 `ItemSlot.cs`를 배열로 저장해서 각 슬롯에 `ItemData.cs`를 저장하고 `ItemData.cs`에서 `enum`으로 활용 하는 곳을 나누고 `enum` 값에 맞게 버튼 활성화 및 활성화된 버튼을 누를 시 패턴을 구현했습니다. 
<br>

- 학습한 부분 확인하기
  - 인벤토리 만들기
  - `enum`을 활용한 방법 나누기
<br>

### 장비 장착
- 구현 방법<br>
`Inventory.cs`에서 장착하기를 누를 시 `Equipment.cs`에서 Instantiate로 무기를 장착, 해제하도록 구현했습니다.
데미지 판정이나 애니메이션은 미 구현되었습니다.
<br>

### 다양한 아이템 구현
- 구현 방법 <br>
위 내용처럼 `ScriptableObject`로 각각 다른 타입의 아이템을 만들었습니다. 총 3가지로 모두 검의 형태지만, 하나는 Material를 적용해서 빨간 장착 검, 일반 장착 검, 먹을 수 있는 검으로 구현했습니다.
또한 기존 강의에서는 체력, 배고픔, 스태미나만 회복 가능하도록 했는데, 저는 `PlayerKey.cs`의 `MoveSpeed`와 `JumpPower` 또한 `ItemData.cs`의 능력치 타입에 추가하여 적용할 수 있도록 했습니다. 영구 증가되는 것과 그렇지 않은 것도 구분하도록 만들었으며, 일정시간 증가의 경우, 코루틴을 활용하여 능력이 사라지도록 만들었습니다. 
<br>

- 학습한 부분 확인하기
  - `ScriptableObject` 로 데이터 나누기
  - `Material` 활용한 검 이미지 입히기
  - `Coroutine` 을 통한 아이템 지속시간 구현
  - `enum`의 확장하기
<br>

---
## 플랫폼
<br>

---
### 점프대
- 구현 방법 <br>
조건에서 말한 방식대로 OnCollider를 활용하여 블럭 위에 플레이어가 있다면 AddForce로 날아가도록 만들었습니다. 
<br>

### 움직이는 플랫폼
- 구현 방법<br>
`MoveZone.cs`를 만들어 `Point` struct에 Vector3과 speed를 넣고 배열로 만들어 4곳을 지정하여 순차적으로 다른 속도로 움직이게 했습니다. 부드러운 움직임을 위해서 `Rigidbody`를 활용했으며, velocity 대신 `MovePosition`과 그 값을 `Lerp`로 부드럽게 움직이도록 해보았습니다.
또한 플레이어가 플랫폼에 올라탔을 때, 움직이는 코드는 `PlayerInteract.cs`를 만들어 외부의 입력에 반응하게 했습니다. 
<br>

- 학습한 부분 확인하기
  - 플랫폼 움직이기 
  - 플랫폼에 올라타기
<br>

### 플랫폼 발사기
- 구현 방법<br>
이 내용은 [움직이는플랫폼](#움직이는-플랫폼)에서 구현한 거에 이어서 만들었습니다. `PlayerInteract.cs`에 코루틴을 통해 일정 시간 플랫폼 위에 붙어있다면, 앞 점프를 하도록 만들었습니다.
<br>

- 트러블 슈팅
1. 플레이어의 시선 위치에 반응하는데 rotation 값 때문에 바닥에 박힘.
  1. `Quaternion.Euler`를 통해 몇 차례 회전을 통해 올바르게 점프하도록 설정.
2. 플레이어의 X, Z좌표값이 고정되어 있어서 앞 점프는 되지 않는다. 
  2. 플레이어가 플랫폼의 의해 점프했을 때, velocity가 마이너스 되기 전에 move 정지로 했습니다.
<br>

- 학습한 부분 확인하기
  - 좌표 고정 문제 해결 탐구
  - `Quaternion` 활용하기
  <br>

### 레이저 트랩
- 구현 방법 <br>
`RaizerZone.cs`를 따로 만들어서 ray를 촘촘하게 쏘아 플레이어가 맞을 시, Debug.Log에 사망이 뜨도록 구현했습니다. 초기에는 `Gizmos`만을 활용하여 씬에서만 보이도록 만들었었는데 보기 불편함을 느끼고 `LineRenderer`를 통해 게임에서도 보이도록 만들었습니다.
<br>

- 트러블 슈팅
1. Ray를 맞는 판정이 생각했던 범위와 달랐습니다.
  1. ray는 현 좌표와 방향에 따라 움직이는데 저는 현 좌표, (현좌표+방향)이라 문제가 생겼던 것이었고
  2. 이를 수정하여 해결했습니다. 
<br>

- 학습한 부분 확인하기
  - `LineRenderer` 활용 방법
  - `Ray`의 값 이해
<br>

---
## AI
<br>

---
### 발전형 AI
- 구현 방법 <br>
`NavMesh`를 통해 몬스터의 이동 가능한 지역을 지정하고, `easy_Monster`는 무조건적으로 플레이어를 쫓아다니게 만들어, 가중치가 설정된 부분을 바로 넘어가면 몬스터가 바로 접근하지 않고 다른 길로 돌아 온다는 것을 확인할 수 있었습니다.
<br>

- 학습한 부분 확인하기
  - `NavMesh` 를 활용한 Bake 및 가중치 설정
  - `NavMeshAgent`의 활동 가능 범위 지정
<br>

---
